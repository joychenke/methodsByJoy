<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>post传数据，并导出</title>
</head>

<body>
	<script>
		//创建一个form表单，url是接口url，请求方式是post
		// 导出表格
		export function exportExcel(url, data) {
			let encodeParam = function (json) {
				let tmps = [];
				for (let key in json) {
					tmps.push(key + '=' + json[key]);
				}
				return tmps.join('&');
			}
			let urls = url + encodeParam(data);
			//判断是否有id为_exportForm的form表单，如果没有则创建一个隐藏的form，把url放入，然后submit
			let exportForm = document.getElementById("_exportForm");
			if (!exportForm) {
				exportForm = document.createElement("form");
				exportForm.setAttribute('id', "_exportForm");
				exportForm.setAttribute("action", urls);
				exportForm.setAttribute("method", "post");
			}
			document.body.appendChild(exportForm);
			exportForm.submit();
			document.body.removeChild(exportForm); //导出成功后将form元素移除以免影响下一次导出
		}

	</script>
</body>

</html>
