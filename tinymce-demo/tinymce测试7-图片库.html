<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <!-- <script src="jquery.iframe-post-form.js"></script> -->
    <script src="jquery.form.js"></script>
    
	<script src="tinymce4.8.2/tinymce.min.js"></script>

	<title>tinymc测试6-plugins</title>
	<style>
	.mce-window {
        transform: initial !important;
    }
    </style>
	<script type="text/javascript">
		tinymce.init({
			selector: '#myTextArea',
            theme: 'modern',
            language: 'zh_CN',
			menubar: false,
			width: 750,
			height: 250,
			autoresize_min_height: 350,
			imageupload_url: 'serverAddress/file/fileUpload', //图片上传地址
			plugins: [
				"advlist autolink print preview link  imageupload"
			],
			toolbar: "insertfile undo redo | bold | print preview | imageupload link",
			convert_urls: false,
			// init_instance_callback: setTinyContent
        });
        
        //上传后的处理函数
        $('#uploadImageForm').ajaxSubmit({//图片上传form表单的id是uploadImageForm，是个定值
        dataType: 'json',
            success: function(response){
                if (response.url) {
                    var tpl = '<img src="%s" width="220" data-key="%k"/>';
                    var tplV = tpl.replace('%s', response.url);
                    tplV = tplV.replace('%k', response.key);
                    ed.insertContent(tplV);
                    ed.focus();
                    removeForeground();
                    removeBackground();
                } else {
                    showImageUploadError('上传失败，请重试！');
                }
            },
            error: function(){
                showImageUploadError('上传失败，请重试！');
            }
        });

        //
        $("#sendContent").click(function () {
            console.log1()
				alert(getHtml("myTextArea"));
				
			});

			function getHtml(editorid) {
				if (editorid == "")
					return "";
				for (var i = 0; i < editors.length; i++) {
					var editor = editors[i];
					if (editor.id == editorid)
						return editor.getBody().innerHTML;
				}
				return "";
		}


	</script>
</head>

<body>
	<div>
        <p>配置toolbar和menu https://blog.csdn.net/zjiang1994/article/details/79880806</p>
    </div>
	<form method="post">
        <label>公告标题：</label>
        <input type="text" name='noticeTitle'><br/>
        <label>公告类型</label>
        <input type="text" name='noticeType'><br/>
        <label>正文：</label>
        <textarea id="myTextArea"></textarea><br/>
        <label>附件</label>
        <input type="file" name='attachment'><br/>
        <label>发送对象</label>
        <input type="text" name='sendType'><br/>
        <input type="submit" value="提交">
    </form>
    
</body>

</html>
